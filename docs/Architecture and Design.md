# LenkCare Architecture and Design

## Purpose

LenkCare Homes is an internal web application designed to streamline the management of multiple adult family homes in the U.S. It serves as a centralized system for an operator to manage residents (clients), staff (caregivers), and day-to-day care activities while maintaining strict compliance with **HIPAA** regulations. The application will facilitate real-time recording of caregiving activities, secure storage of health information, and role-based access to sensitive data. By digitizing records such as Activities of Daily Living (ADLs), vitals, and incident reports, LenkCare Homes aims to improve operational efficiency, enhance the quality of care, and ensure regulatory compliance. The system is not publicly accessible – it is intended **for internal use only** by authorized personnel, with robust security measures to protect Protected Health Information (PHI).

## User Roles & Permissions

LenkCare Homes will support three primary user roles, each with specific permissions and access levels, enforced both in the frontend UI and backend API:

* **Admin/Owner:** The Admin (or Owner) has full control over the system’s data and settings. Admins can manage all resources including homes, beds, clients, caregivers, and documents. They can create and edit user accounts, assign caregivers to homes, upload sensitive client documents, and configure which caregivers can view specific documents. Admins also have access to administrative functions such as generating reports and viewing audit logs. In essence, Admins oversee the entire application and ensure data integrity and compliance.
* **Caregiver:** Caregivers are staff members who provide daily care to clients. A caregiver’s access is limited to the homes they are assigned to – **caregivers can only view and interact with client data for the home(s) they are assigned to**. They do *not* manage system-wide settings but have capabilities to log daily care information for clients under their care. This includes recording ADLs, vital signs, behavior notes, etc., for clients in their assigned home. Caregivers may also view certain client documents (e.g. care plans) but **only if the Admin has granted access on a per-document basis**. They cannot download or edit these documents; viewing is strictly read-only for approved documents to protect data from improper distribution.
* **Developer/Sysadmin:** This role is intended for **internal IT personnel only** responsible for system maintenance, support, or development. The **system administrator role will have no privileges to modify PHI data**; they can only access system-wide audit views and non-PII information. They can manage application configuration, view comprehensive audit logs, and perform tasks like resetting user MFA or troubleshooting issues. System admins will use unique credentials and be required to use MFA (as required by HIPAA)[[1]](https://compliancy-group.com/azure-hipaa-compliance/#:~:text=,that%20it%20is%20accessed%20in). The SysAdmin role can view patient lists or home records (with non-sensitive fields only) but **cannot** see or modify sensitive PHI. Only authorized clinical users (Admins, Caregivers) can view/edit actual PHI. This role ensures the system remains operational and secure. Only IT staff will have Sysadmin credentials – business staff (Admins, Caregivers) will not have access to this role.

**Initial System Setup:** One initial Admin account will be created manually during deployment/database seeding to bootstrap the system. This Admin can then create additional Admin or Caregiver accounts as needed.

**Role-Based Access Control:** The system will enforce role-based access throughout. For example, if a caregiver attempts to access a client record outside their assigned home, the frontend will hide or disable that action, and the backend will also strictly validate permissions on every request. Similarly, only Admins and Developer/Sysadmins will have UI options to manage system data or view logs. This layered enforcement prevents unauthorized access both via UI and any direct API calls[[1]](https://learn.microsoft.com/en-us/answers/questions/2265200/azure-ai-baa-hipaa-compliance#:~:text=c). All user roles must use multi-factor authentication (MFA) to log in, adding another layer of protection for PHI access[[2]](https://learn.microsoft.com/en-us/answers/questions/2265200/azure-ai-baa-hipaa-compliance#:~:text=%2A%20Implement%20Role,Reference).

## Functional Requirements

The functional requirements are organized into modules for clarity. Each module outlines specific capabilities and includes acceptance criteria to clarify what is needed for successful implementation.

### 1. Home & Bed Management

**Description:** Admins need to set up and manage the adult family homes and their bed assignments in the system. Each home will have a set of uniquely labeled beds (e.g. “Room 1 – Bed A”, “Room 1 – Bed B”, etc.). These bed labels are static identifiers that remain associated with the physical bed; when a client is discharged, the bed becomes available under the same label for a new admission rather than being deleted or renamed. This consistency is important for record-keeping and regulatory tracking.

**Features:** Admins can create a new Home record with details like home name, address/location, contact info, and capacity (number of beds). The Admin can then define the beds for that home, assigning each bed a label/name. Beds can be added or inactivated by the Admin if, for instance, a bed is taken out of service. Caregivers will be linked to homes (not to individual clients), so the home is a primary container for organizing caregiver access and client lists.

**Acceptance Criteria:**

* Admin can **create a Home** by providing required details (name, address, etc.). The system will save the home and generate a unique identifier for it. After creation, the home appears in the home list/dashboard for Admins.
* Admin can **configure beds for a Home**. They can add a fixed number of bed entries, each with a static label. Example: If a home has 4 beds, Admin creates 4 bed records labeled “Bed 1” through “Bed 4” (or any custom naming convention). These bed labels are persistent.
* The system prevents duplicate bed labels within the same home. Each bed within a home must have a unique identifier/label.
* **Assigning/Unassigning Beds:** When admitting a new client (see Client Management), an Admin must assign the client to one of the available beds in a home. If a bed is occupied, the system will not allow assigning another client to that bed. When a client is discharged, the bed is marked as available for future assignments.
* Admin can **edit Home information** (e.g., update address or contact info) and **deactivate/retire a Home** if it is no longer in use. Deactivating a home should only be allowed if no active clients reside there (or the action should warn the Admin to discharge all clients first).
* Only Admin or Developer/Sysadmin roles can perform home and bed management actions. Caregivers have read-only visibility of their assigned home’s name and bed labels (for context) but cannot modify them.

### 2. Client Management

**Description:** The system will manage detailed records of each client (resident) in the homes. Clients are elderly or disabled individuals under care. Each client must be associated with a specific home and bed. The system should maintain current client information and allow discharging clients when they leave or transfer out of the facility. Historical data for discharged clients must be retained for compliance (rather than deleting client records).

**Features:** Admins can create a new client profile, including personal details (name, date of birth, gender, etc.), medical details (diagnoses, allergies, primary physician, etc. as needed for care), and admission date. During creation, the Admin will assign the client to an **available bed** in one of the homes. The bed’s status will change to “occupied” until the client is discharged. The system will ensure a client is always tied to a bed (no “floating” clients without beds) and one client per bed at a time. Discharging a client will mark that bed as free for reuse.

**Acceptance Criteria:**

* Admin can **create a Client record** with all required fields (e.g., First/Last Name, DOB, etc.) and select a Home and an available Bed for them upon admission. The system should validate that the selected bed is currently unoccupied.
* Upon successful creation of a client, the client appears in the active client list for that home. The bed is marked as occupied by that client.
* Admin can **view and edit client details** (except perhaps certain key identifiers). Editing may include updating contact info, adding notes, etc. Any edits to client information (like health data) should be tracked in the audit log.
* Admin can **discharge a client**. This process will likely include specifying a discharge date (and possibly a reason or destination). Once discharged, the client’s status becomes inactive. The system must:
* Mark the previously occupied bed as available.
* Retain the client’s data in an “inactive clients” archive (for historical reference and compliance) rather than deleting it.
* Ensure that caregivers no longer see the discharged client among active clients in their home (unless there’s a special view for discharged clients for Admin reference).
* Caregivers can **view the list of current clients** in their assigned home(s), along with basic info (name, photo if available, bed label, perhaps relevant alerts like allergies). They cannot create or delete clients. They also cannot see clients from homes they are not assigned to.
* The system should handle **bed reassignments** logically: a client cannot be moved to a new bed unless through an Admin action (e.g., internal room transfer). If such transfers are allowed, the Admin can update the client’s bed assignment, provided the target bed is free. The history of bed assignment changes should be logged.
* All client PHI (personal and health details) must be stored securely in the database (Azure SQL) with encryption at rest[[3]](https://azure.microsoft.com/en-us/explore/trusted-cloud/privacy#:~:text=,between%20user%20devices%20and%20Microsoft). Access to client data is restricted based on role (only Admins and caregivers of the same home can view client profiles).

### 3. Caregiver Management & Assignment

**Description:** Caregivers are users of the system who will log in and record care data. They are invited and managed by Admins – there is no self-registration for security reasons. Each caregiver user must be associated with one or more homes that they work in, determining which clients’ data they can access. The module covers creating caregiver accounts, onboarding (sending invite links), managing their home assignments, and managing credentials (password resets, MFA resets).

**Features:** Admins can add a new caregiver by entering their name and email (and any other required info like phone number). The system will create an account for that email and send an **invitation link** via email for the caregiver to set their password and complete MFA setup. The authentication system (ASP.NET Core Identity) will handle verification steps such as email confirmation and TOTP setup. Admin can also deactivate caregiver accounts (e.g., if an employee leaves) and reassign or remove them from homes.

**Acceptance Criteria:**

* Admin can **invite a new Caregiver** by providing their email and name. Upon doing so, the system triggers an invite email containing a secure link for account setup. The invite link should allow the caregiver to set a password and configure TOTP MFA for their login. Until the caregiver completes this process, their account might be marked as “pending activation”.
* The system uses **ASP.NET Core Identity** for authentication, which supports email/password login and **TOTP (Time-based One-Time Password) for MFA**[[2]](https://learn.microsoft.com/en-us/aspnet/core/security/authentication/mfa?view=aspnetcore-10.0#:~:text=MFA%20TOTP%20%28Time,Algorithm). This ensures that after entering their password, caregivers must input a 6-digit code from their authenticator app. The MFA requirement is applied to *all* users (Caregivers, Admins, Developers) to meet security best practices for PHI access[[1]](https://compliancy-group.com/azure-hipaa-compliance/#:~:text=,that%20it%20is%20accessed%20in).
* **No public self-signup:** There is no public registration page. Only Admins (or Sysadmin) can create new user accounts. The invite process should enforce that only intended recipients gain access (e.g., invite links expire after a certain time for security).
* Admin can **assign homes to a caregiver**. For each caregiver, the Admin selects one or multiple homes that the caregiver will have access to. The UI should allow managing these assignments (e.g., a multi-select list of homes). If a caregiver is assigned to multiple homes, they will have the ability to switch context in the UI to view data for each of their homes (if applicable). If a caregiver is assigned to no home (not likely in normal operation), they effectively have no client access.
* Caregivers’ access should be limited accordingly:
* They can see the list of clients (and related care data) only for their assigned home(s).
* They cannot see any indication of clients or data from unassigned homes. For example, if a caregiver attempts to access a URL for another home’s client, the system should return an authorization error.
* Admin can **deactivate or delete a caregiver account**. Deactivation keeps the caregiver’s historical records (e.g., their past care logs remain associated with their name for audit) but prevents them from logging in. Deletion (if allowed at all) should be used with caution because audit trails should generally not remove user identities entirely. In most cases, we will prefer *deactivation* over deletion to preserve data integrity.
* **Password and MFA Resets:** The system provides secure workflows for resetting a caregiver’s password (e.g., “Forgot Password” link that emails a reset link) and for MFA recovery. If a caregiver loses access to their authenticator app, there should be a process to regain access:
* Ideally, ASP.NET Core Identity will provide **backup codes** for 2FA which the user is instructed to save during setup. The caregiver can use a one-time backup code to log in if their device is lost.
* Alternatively or additionally, an Admin or Developer/Sysadmin can reset the caregiver’s 2FA settings (after verifying identity out-of-band). Such an action will be logged in the audit log for security tracking.
* All communications (invite emails, password reset emails) must be done via secure channels and should not include any sensitive PHI. They should expire or be single-use to prevent misuse.

### 4. Document Management (File Storage & Access Control)

**Description:** The system will allow Admins to upload and manage documents related to clients, such as care plans, medical reports, consent forms, etc. These files often contain PHI and must be stored and accessed securely. A key requirement is that Admins can control which caregiver(s) are allowed to view each document on a **per-individual-document basis**. Caregivers will see a list of all documents for clients in their assigned home, but can only open documents the Admin has explicitly granted them access to. Caregivers may request access to documents they cannot currently view. Caregivers will only be permitted to *view* documents (e.g., in the browser) – they should not be able to download or edit them, ensuring an extra layer of data control.

**Document Viewing Approach:** For PDFs, the system will use an embedded PDF viewer (such as PDF.js) with the download button hidden/disabled. This provides a **best-effort view-only experience** – we acknowledge that determined users could still screenshot or use browser developer tools, but casual downloading is prevented. Non-PDF documents (Word, Excel, etc.) that cannot be rendered in-app will need to be handled outside the system (e.g., Admin sends via secure email if needed).

**Features:** Documents uploaded will be stored in **Azure Blob Storage** in a secure container. Each file will be associated with a client (and possibly tagged by document type or date). Admins can manage these documents via the UI: uploading new files, organizing them (e.g., categories or descriptions), and removing/updating them if needed. For each document or each client’s document collection, the Admin will assign viewing permissions to specific caregivers. For example, if Client A has a medical report, the Admin might allow caregiver John Doe to view it, but not caregiver Jane Smith, depending on need-to-know.

**Acceptance Criteria:**

* Admin can **upload a document** for a specific client. The upload form will require selecting the client, and possibly a document name or type (e.g., “Care Plan”, “Medication List”, etc.), then choosing the file from the local system. Upon upload, the file is stored in Azure Blob Storage and a reference (metadata record) is saved in Azure SQL (including which client it belongs to, the file name, file type, upload date, etc.).
* The system must **encrypt documents at rest** in blob storage (Azure Blobs are encrypted by default with 256-bit AES[[3]](https://azure.microsoft.com/en-us/explore/trusted-cloud/privacy#:~:text=,between%20user%20devices%20and%20Microsoft)). Access to the storage is via secure APIs. The application will not serve raw file URLs without authorization – ideally, a document is fetched via a secure endpoint that checks the user’s permissions, then streams the file to the browser.
* Admin can **assign document access** to caregivers. This could be done at upload time (e.g., a checklist of caregivers in the client’s home to grant access to) and/or later by editing the document’s permissions. Only caregivers already assigned to the same home as the client will be available for selection (since others should not even know of the client’s existence). The system should allow multiple caregivers to have access to the same document, and also allow revoking access if needed.
* Caregivers **can view documents** they have been granted access to:
* These documents will be listed in the client’s profile or a documents section for that client. Caregivers without access should not see the document listed at all (security through obscurity and access control).
* When a caregiver opens a document, it should display in-app (for example, in a PDF viewer component or image viewer). There will be no direct download button. The application should also use technical controls to discourage downloading (for instance, streaming PDFs with a viewer that hides the download icon). However, note that *no solution can 100% prevent a determined user from saving data (e.g., screenshots)*. The requirement is to make casual downloading/editing impossible and log any access.
* The UI should watermark or indicate that the document is confidential if feasible (e.g., “Confidential – For Internal Use”).
* **No Editing by Caregivers:** Caregivers cannot modify or delete documents. Only Admins (and Sysadmin) can upload new versions or remove a document. If an Admin replaces a document (e.g., updated care plan), prior versions could either be retained as history or overwritten – this is a design decision. For HIPAA, retaining historical versions might be wise (for audit purposes), but at minimum all actions are logged.
* **Download by Admin:** Admins are allowed to download documents (since they uploaded or manage them, and may need to print or send to doctors, etc.). If they do so, the action is logged. For caregivers, direct download links will be disabled.
* The application will ensure **secure transit** of documents when viewing/downloading – all connections use HTTPS/TLS 1.2+ to protect PHI in transit[[6]](https://azure.microsoft.com/en-us/explore/trusted-cloud/privacy#:~:text=,IPsec).
* All document access events (view, upload, download, permission changes) are recorded in the audit log with timestamp, user, and action details (e.g., “Caregiver X viewed Document Y of Client Z on date/time”).

### 5. Activities of Daily Living (ADL) Tracking

**Description:** Caregivers will record Activities of Daily Living for clients multiple times a day. LenkCare Homes will incorporate an ADL tracking module based on the **Katz Index of Independence in Activities of Daily Living**. The Katz Index defines six key ADLs: bathing, dressing, toileting, transferring, continence, and feeding[[7]](https://www.h2hhc.com/blog/katz-index-of-independence#:~:text=The%20Katz%20Index%20of%20Independence,toileting%2C%20transferring%2C%20continence%2C%20and%20feeding). By tracking these, caregivers can document the level of assistance a client needs with each activity, providing critical information for care planning and compliance.

**Features:** For each client under their care, caregivers can create ADL entries. An entry might cover one or more of the six categories, typically for a given time (e.g., morning routine or evening routine). The caregiver can indicate for each ADL whether the client was independent, needed assistance, or the task was performed for them. The interface should make it quick and easy to log these, as they happen potentially several times per day.

**Acceptance Criteria:**

* Caregiver can **open an ADL logging form** for a specific client. The form will list the six ADL categories (bathing, dressing, toileting, transferring, continence, feeding) with input options for each. Input could be a simple checkbox or toggle (e.g., “Completed by client independently” vs. “Caregiver assisted”) or a more detailed dropdown (e.g., “Independent / Partial Assist / Dependent”). For simplicity and alignment with Katz scoring, a binary or three-level scale may be used for each ADL.
* The caregiver can **submit the ADL form** once filled. The system records an ADL log entry with:
* Timestamp (date and time, which could default to now but caregivers might adjust if logging after the fact).
* The caregiver’s user ID (so we know who logged it).
* The client ID.
* For each ADL category, the recorded level or notes.
* The system should allow logging ADLs **multiple times a day**. For example, a caregiver might log a morning ADL assessment and an evening assessment. Each submission creates a separate record. In reports, these can be aggregated by day.
* **Katz Index Reference:** If using Katz scoring, each ADL category might translate to a score (1 = independent, 0 = dependent)[[8]](https://www.h2hhc.com/blog/katz-index-of-independence#:~:text=Scoring%20the%20Katz%20ADL%20Index). The system might compute a total Katz score for that entry or per day. However, for our purposes, we mainly store the qualitative info. (If desired, acceptance could include that the system calculates a Katz score out of 6 for each log or each day, but this is optional.)
* **View ADL History:** Caregivers and Admins should be able to view past ADL entries for a client. For caregivers, this might be restricted to a certain recent timeframe (e.g., last 7 days) or their own entries, whereas Admins could view the full history. The ADL history should show the date/time, the caregiver who logged it, and the values (possibly in a summarized text or table format).
* Data from ADL logs will be used in reports. For example, an Admin might generate a monthly report of all ADL logs for a client to detect trends (improvement or decline in independence).
* **Validation:** All ADL logs should require at least one category to be addressed (so caregivers don’t accidentally submit an empty form). If a certain ADL was not applicable at that time (e.g., no bathing done in that shift), caregivers might leave it blank or mark “N/A”. We should define a consistent approach (maybe “Not applicable” checkbox or assume missing means not done).
* Each ADL submission is timestamped and immutable – caregivers should not be able to edit past entries, only add new ones (this maintains the integrity of the care record). If a correction is needed, they might add a new note entry (or an admin can correct with audit trail). This is to ensure historical records are not tampered with, aligning with audit requirements[[9]](https://compliancy-group.com/hipaa-audit-log-requirements/#:~:text=Application%20audit%20trails,application%20records%20associated%20with%20ePHI)[[10]](https://compliancy-group.com/hipaa-audit-log-requirements/#:~:text=HIPAA%20Audit%20Log%20Requirements).

### 6. Vitals Monitoring

**Description:** Caregivers will record vital signs for clients, such as blood pressure, pulse, temperature, and oxygen saturation (O₂). This module provides a structured way to input and review these critical health metrics. Regular monitoring of vitals is essential for detecting health issues early and tracking a client’s condition over time.

**Features:** The system will present a vitals input form for caregivers. The key fields include: - **Blood Pressure (BP):** Typically recorded as Systolic/Diastolic (e.g., 120/80 mmHg). - **Pulse (Heart Rate):** In beats per minute. - **Temperature:** In degrees Fahrenheit (or Celsius, but likely Fahrenheit in U.S. adult homes), including one decimal if needed (e.g., 98.6°F). - **Oxygen Saturation (SpO₂):** As a percentage (e.g., 97%).

Caregivers can log these vitals for a client at various times (e.g., morning, afternoon, as needed). The data will be timestamped and stored for trend analysis. The UI might allow optional fields if some vitals are not taken at a given time.

**Acceptance Criteria:**

* Caregiver can **open the Vitals entry form** for a client. The form will have input fields for BP, Pulse, Temperature, and O₂ saturation. BP might be two fields or a single field with a separator for systolic/diastolic. Temperature field should allow one decimal place (and possibly auto-append units or have a dropdown for units, defaulting to °F).
* Caregiver can **submit vitals**. Upon submission, the system validates the inputs are in a plausible range (to catch typos, e.g., pulse not 1000, temperature not 150°F). If any required vitals were measured as blank, that’s acceptable (not every reading may be done every time), but at least one vital should be present to avoid empty submissions.
* The system saves the vitals record with timestamp, the caregiver’s ID, and the client’s ID. The data is stored in Azure SQL under the client’s records.
* **View Vitals History:** Caregivers and Admins can view historical vitals for a client. For example, a chart or list of the last N vitals entries might be shown in the client’s profile. This helps caregivers see trends (e.g., BP trending high). Admins might use this to review care or include in reports to doctors or during audits.
* If a vital is **outside normal range**, the system could flag it (e.g., highlight in red or show an alert). This is a potential feature: for instance, if O₂ is below 90% or temp above 101°F, etc., it could prompt the caregiver to double-check or inform a nurse/Admin. However, any alerting logic should be discussed – initial requirement is just recording, not real-time alerts.
* All vital entries are also recorded in the audit log (by virtue of being data updates). The content of the vitals (numbers) might not be in the audit log, but the fact “Caregiver X recorded vitals for Client Y at 10:00 on 2025-11-27” is logged.
* Data is kept long-term for compliance and trend analysis. There should be no automatic purging of vitals data.

### 7. Range of Motion (ROM) Exercises Logging

**Description:** Range of Motion exercises help maintain or improve a client’s mobility. Caregivers often assist clients with ROM exercises (for arms, legs, etc.) especially if they are bed-bound or have mobility issues. This module allows caregivers to log ROM activities performed with or by a client, including what was done and any observations (like increased stiffness or pain).

**Features:** A simple logging interface for ROM activities will be provided. This might include fields like: - Type of exercise or body part (e.g., “Shoulder stretches”, “Leg ROM”). - Duration or repetitions (e.g., “10 minutes” or “3 sets of 5 reps”). - Notes or observations (text field for anything noteworthy, such as “client tolerated well” or “client complained of pain in left knee”).

**Acceptance Criteria:**

* Caregiver can **open a ROM log form** for a client. The form allows input of:
* **Activity description:** possibly a dropdown of common exercises or free text.
* **Duration/Reps:** numeric or text input (not mandatory to structure too strictly, but we want them to note how much was done).
* **Notes:** optional text for any details.
* On **submitting the ROM log**, the system saves the entry with timestamp, caregiver, client, and the entered details.
* Multiple ROM entries can be logged per day as needed. Each entry is separate and will show up in chronological order in the client’s activity history.
* **Viewing ROM logs:** Similar to ADLs and vitals, a history of ROM activities is visible. Likely, these would appear alongside other daily log entries or in a dedicated “Exercises” section of the client profile.
* The system does not enforce particular exercise protocols – it’s a free-form log, but caregivers should be encouraged to be consistent in descriptions (perhaps training/guidelines outside the system). The PRD scope is to capture whatever they input.
* All ROM log actions are recorded (as part of data change logs). If a caregiver logs or if an Admin ever needed to edit a log, those changes are auditable.
* **Optional**: If needed, Admins could generate a report of ROM activities over a period (e.g., to show physical therapists what was done). For now, it’s stored and can be part of the general reporting module if filtered by category.

### 8. Behavior and Mood Notes

**Description:** Caregivers should note significant behaviors, mood changes, or psychological observations about clients. This could include notes on agitation, confusion episodes, depression signs, refusal of care, or positive interactions. Such notes provide context to a client’s day and can be vital for healthcare providers or family to understand the client’s well-being beyond just physical health.

**Features:** A free-form text logging for behavior/mood notes, possibly with tagging of category (behavior, mood, etc.). Caregivers enter a note describing what occurred and when. This is typically unstructured narrative, but we store it with a timestamp and caregiver info.

**Acceptance Criteria:**

* Caregiver can **open a Behavior/Mood note entry form** for a client. This form might simply have a text area for the note and possibly a dropdown to categorize the note (e.g., “Behavior” vs “Mood” if we want to distinguish, or a few preset tags like Agitation, Elopement attempt, Happy mood, etc.). Initially, a general text note is sufficient.
* On **submit**, the note is recorded in the system with the current timestamp (or selectable time if logging later) and the caregiver’s identity. For example: “2025-11-27 2:00 PM – Note: Client appeared anxious and was pacing. Refused lunch initially but ate after 15 minutes. – by Caregiver Jane D.”
* Notes are immediately visible to other caregivers of the same home and to Admins (in case multiple shifts caregivers need to see what happened earlier in the day). This helps continuity of care.
* **Viewing Notes:** There should be an aggregated view of all Behavior/Mood notes in reverse chronological order for the client. Possibly this is part of a client’s daily log feed or a dedicated section. It should display the content, author, and time.
* Caregivers cannot edit or delete a note after submission (to maintain integrity), but if an error was made, they could add a correcting note. Admins might have the ability to correct typos or remove an inappropriate note, but such actions should be rare and all edits/deletions must be logged.
* These notes will be included in **reports** if an Admin generates, for example, a monthly summary of the client’s status, to give context to any incidents or changes.
* The text field should have a reasonable length limit (e.g., 1000 characters) to encourage concise notes and not overwhelm the system, but also not too short that important detail is omitted.
* All notes are stored as part of the client’s record and are considered part of the medical record (and thus PHI). They should be protected and only accessible to authorized users. Access logs (audit trail) will record if an Admin or caregiver viewed the notes section.

### 9. Recreational Activity Logging

**Description:** Recreational and social activities are key to quality of life in adult family homes. This feature allows caregivers or activity coordinators to log when clients participate in individual or group activities (e.g., games, exercises class, arts and crafts, outings). It helps track engagement and can be useful for care plans or state inspections (proving that the facility provides activities).

**Features:** The logging can be done in two ways: - **Individual activity entry:** For one client engaging in some activity (e.g., “Client read a book for 30 minutes” or “One-on-one walk in the garden”). - **Group activity entry:** Logging a group event (like a bingo game or movie time) and marking multiple clients as participants in one go, to avoid duplicate data entry.

The system should capture the activity description, time/duration, and participants.

**Acceptance Criteria:**

* Caregiver/Admin can **create an Activity log**. This includes:
* **Activity Name/Description:** e.g., “Bingo Night”, “Music Therapy Session”, “Walk in Park”.
* **Date & Time or Duration:** e.g., occurred on 2025-11-27 at 3 PM, lasting 1 hour.
* **Participants:** select one or multiple clients who took part. The UI could present a list of current clients in that home with checkboxes. (Only clients from the caregiver’s home can be selected, naturally.)
* Optionally, **Category** (Recreational, Social, Exercise, etc., for reporting purposes).
* Upon submission:
* If one client was selected (or it’s an individual activity), a log entry is created for that client.
* If multiple clients were selected (group activity), the system creates a log entry for each client (so their individual records show the activity) or a single group record that references multiple clients. Implementation-wise, duplicating the entry per client might simplify retrieval per client.
* **Viewing Activities:** In each client’s profile or daily log, their participation in activities is listed. For example, “2025-11-27 – Participated in Bingo Night (Group Activity with 5 residents) for 1 hour.” If group events are logged, it might also be useful for Admin to see a **group activity log** somewhere (like “Bingo Night included these 5 clients”).
* Only authorized users can log activities. Typically caregivers will do this, but Admins might also add if they organize events. Developer/Sysadmin wouldn’t normally be involved here.
* **Edit/Delete:** If a mistake is made (e.g., wrong client marked), an Admin should be able to correct the activity log (or delete and re-enter it). Edits and deletions are, as always, captured in the audit log.
* **Reporting:** Admins can generate reports on activities – e.g., list of activities a particular client engaged in during a month, or a home-wide activity attendance report. This is helpful for internal evaluation of engagement and also can satisfy some state requirements for social activities.
* The system should encourage logging by making it quick to add these. Perhaps the UI could allow a caregiver to copy a previous activity’s participant list if it’s a recurring group event to save time.
* As with all modules, any sensitive information (though activities are not highly sensitive, they still tie to client identities) is protected in transit and at rest.

### 10. Incident Reporting

**Description:** In the context of caregiving, an **incident** refers to any unusual or adverse event involving a client – for example, a fall, medication error, injury, aggressive behavior, or any reportable event defined by regulations. Incident reports are critical for compliance and quality improvement. The system will provide a form for caregivers or admins to document incidents, which can then be reviewed by management and kept on record for audits.

**Features:** The incident report form will be more detailed than a simple note. It should capture: - **Incident type/category:** e.g., Fall, Medication error, Injury, Behavioral incident, Other. - **Date and time of incident.** - **Location:** (if needed, e.g., in room, in bathroom, outside facility, etc.) - **Persons involved:** Typically the client, but possibly others (maybe an optional field if more than one client or a staff injury). - **Description of the incident:** a narrative of what happened. - **Action taken:** what was done in response (first aid given, doctor called, etc.). - **Reporter:** autofill with the user submitting, but might include a place to note if someone else initially witnessed it. - Possibly **Witnesses or Notifications:** e.g., “Family notified at X time”, “Doctor notified”, etc., depending on requirements.

**Acceptance Criteria:**

* Caregiver or Admin can **open the Incident Report form**. It should include fields mentioned above with appropriate input types (dropdown for category, datetime picker, multiline text for description and actions).
* **Submitting an incident report:** The system validates required fields (at least category, datetime, description are mandatory). On submit:
* The incident is recorded in the database with a unique ID.
* It is marked as associated with the specific client (or clients) it concerns.
* The submitting user and timestamp are recorded.
* After submission, the incident report becomes **read-only** for caregivers. They cannot modify it (to ensure the integrity of the report). If additional information needs to be added, an Admin could append a note or update the report, but all changes must be tracked.
* **Incident Review Workflow:** Each incident will have a status field with values: **New**, **Reviewed**, and **Closed**. When first submitted, incidents are marked as "New". Admins can review incidents and change the status to "Reviewed" or "Closed". Admins can also add **follow-up notes** to document actions taken, investigation findings, or resolution details. This workflow ensures incidents are properly tracked through to resolution.
* The system might send a **notification** to Admins (if implemented, e.g., an email or an alert in the dashboard) whenever a new incident report is filed, so that management can review it promptly. (This could be a nice-to-have feature: not explicitly requested, but it aligns with ensuring incidents get attention.)
* **Viewing incidents:** Admins can view a list of all incident reports, with filters by home, client, date range, or category. Caregivers should be able to see the incidents they reported and possibly all incidents in their home (this depends on policy; sometimes all staff should be aware of incidents to be vigilant). We may restrict caregivers to see incidents of their own clients/home only, which is likely since they can only see those clients anyway.
* **Printing/Exporting incidents:** There should be a capability for Admin to print or download an incident report (perhaps as PDF) for external reporting (like to a state authority or for client records). This could be part of the general reporting module or an individual export on each incident.
* **Follow-up actions:** Not required for MVP, but possibly track resolution or follow-up in the report (maybe an “outcome” field to be filled by Admin later, such as “Client sent to ER and returned same day” or “Fall investigation completed”). For now, we’ll keep it simple: capture the initial report, and any follow-ups can be new notes or an update to the incident record.
* All incidents are by nature **critical records**. The data must be stored securely and kept indefinitely (or as per retention policy, likely at least 6 years for compliance[[11]](https://compliancy-group.com/hipaa-audit-log-requirements/#:~:text=HIPAA%20audit%20log%20requirements%20include,adhere%20to%20the%20stricter%20standard)). Audit logs will capture creation and any updates to incident records. Incidents should not be deletable by anyone except maybe a Sysadmin in extreme cases (and even then, prefer a status like “voided” if entered erroneously, to avoid actual deletion).

### 11. Reporting Module (PDF Generation)

**Description:** Admins require the ability to generate reports for various needs – monthly summaries, client-specific reports for care plan meetings, or home-wide reports for internal review or regulatory compliance. The system will provide a reporting interface where an Admin can select a scope (single client or entire home), a date range, and the type of report to generate. The output will be a **PDF document** that collates relevant data in a reader-friendly format, which can be downloaded and printed.

**Features:** The system will support two primary report types for MVP: - **Client Summary Report:** For a given client and date range, compile all their records – ADL logs, vitals, incidents, behavior notes, activities – in chronological order or by category. This is useful for reviewing the client's status over time or preparing for a care plan update or doctor's appointment. - **Home Summary Report:** For a given home and date range, compile summary statistics and logs for all clients in that home. For instance, number of incidents in the month, each client's activity participation, occupancy status, etc. This helps the owner see overall operations.

**Report Format:** For MVP, reports will use **tables and lists only** (no charts or graphs). This simplifies implementation while still providing all necessary data. Charts (e.g., vitals trends over time) may be considered for future enhancements.

**Acceptance Criteria:**

* Admin can **navigate to a Reports section**. They have options to choose:
* **Scope:** either select a specific Client (from a dropdown list filtered by home, or search) OR select a Home (for an aggregate report).
* **Date Range:** start date and end date.
* **Report Type/Format:** perhaps “Detailed” vs “Summary” or different templates. (E.g., a detailed client report vs a summary table of all clients. If not specified, assume a default comprehensive report.)
* After input, Admin triggers **Generate Report**. The system will gather relevant data from the database:
* For a client report: fetch that client’s ADLs, vitals, ROM logs, behavior notes, activities, incidents between the dates.
* For a home report: fetch data for all clients in that home in that range. Potentially aggregate by client or by day.
* The system then **formats the data into a PDF**. This could involve creating sections for each data type:
* For example, a client report might have sections: “Client Info (name, DOB, etc.)”, “Summary of ADL scores in period”, “Vitals chart or list”, “Incident list”, etc.
* A home report might list each client and key metrics, or list events chronologically with client labels.
* Once ready, the PDF is available for **download** by the Admin. It should have a clear file name (e.g., “LenkCare\_Report\_Client\_[Name]\_2025-01-01\_to\_2025-01-31.pdf”). The Admin can save or print it.
* **Accuracy and Completeness:** Acceptance means the report must include all relevant records from the period. For instance, if 5 incidents occurred, all 5 are in the PDF. If an ADL or vital was recorded daily, the report should not miss any. We might also include timestamps and caregiver names on entries in the report for clarity.
* **Formatting:** The report should be professional and easy to read (e.g., tables for vitals trends, bullet points for incidents). It should include the company/app name and date generated, and perhaps a disclaimer like “Internal Confidential – contains PHI”.
* **Performance:** Generating a report should be reasonably quick (a few seconds at most for a month of data for one client, potentially longer for home-wide with many clients). If a report is very large (e.g., a year-long home-wide report), the system might need to batch or have a progress indicator. But acceptance is mainly about correctness; performance tuning can be considered a non-functional requirement.
* The PDF generation will occur on the backend (likely using a library or service) to ensure PHI isn’t exposed to client-side. The file might be generated on the fly and streamed to the admin, or stored temporarily in Blob Storage (with secure access).
* All report generations actions are logged (which Admin generated what report and when), because reports contain PHI and we want an audit trail of data dissemination. The content of the report doesn’t go to audit log, but the event does (e.g., “Admin X generated home-wide report for Home ABC covering Jan 2025”).

### 12. Audit Logging & Monitoring

**Description:** Given the sensitive nature of the data, every action in the system that touches PHI or system settings must be logged. The audit log is an immutable record of who did what and when. This is crucial for HIPAA compliance (accountability principle) and for investigating any issues or breaches. The audit log will cover user authentication events, data creation/edit access, and document views, among others.

The application will use **Azure Cosmos DB** to store these audit logs. Cosmos DB is ideal for this kind of semi-structured, append-only data and can handle a high volume of writes. Each log entry might include details like: timestamp, user ID, action type, target object (which client or which document, etc.), and perhaps the before/after values for data changes (or a summary of the change).

**Features:** Admins (and Sysadmin role) can view the audit logs via an interface. They should be able to filter and search, since the log will become large over time. Filtering by date range, by user, by client, or by action type (e.g., “LOGIN” or “UPDATE\_CLIENT\_INFO”) will be helpful. The logs should be **read-only**; no one (even Admin) can modify or delete an audit entry through the app UI.

**Acceptance Criteria:**

* The system **records an audit log entry for all key events**, including (but not limited to):
* User login attempts: success or failure (with reason if failure).
* User logout or session expiration.
* Data access events: e.g., Caregiver views a document (record user, doc ID, client, read access).
* Data creation: e.g., New client added (who added which client).
* Data modifications: e.g., Admin edited client info, or caregiver edited a note (logging old vs new might be ideal, or at least that a change occurred).
* Data deletions or deactivations: e.g., Client discharged, Document removed.
* Permission changes: e.g., Admin granted caregiver X access to Client Y’s documents.
* System configuration changes: e.g., homes added, user roles changed.
* MFA resets or password resets (who triggered it).

Basically any action that touches ePHI or security settings should produce a log. This aligns with HIPAA guidance that systems should record user activities like reading, editing, deleting of PHI, and security-relevant events[[9]](https://compliancy-group.com/hipaa-audit-log-requirements/#:~:text=Application%20audit%20trails,application%20records%20associated%20with%20ePHI)[[12]](https://compliancy-group.com/hipaa-audit-log-requirements/#:~:text=HIPAA%20requires%20healthcare%20organizations%20to,to%20the%20minimum%20necessary%20standard).

* Each log entry includes:
* **Timestamp** (with timezone or in UTC).
* **User** who performed the action (or system identifier if automated).
* **Action description** (a short code and possibly a human-readable message, e.g., “LOGIN\_SUCCESS”, “UPDATE\_CLIENT”, “VIEW\_DOCUMENT”).
* **Resource details:** which record was affected (could be an ID or name, e.g., client ID or document ID).
* **Outcome** if applicable (success/failure, especially for logins or permission checks).
* Possibly **IP address or device info** of the user (for security monitoring, though since internal, maybe less critical, but still useful to log source IP for suspicious activity detection).
* Audit logs are written to **Cosmos DB** immediately as events occur. The write should not significantly slow down the user action (might be done asynchronously or with minimal blocking).
* The audit log store in Cosmos DB is configured to be **immutable** in practice – the application will never issue an update or delete to that container, only inserts (append-only). This ensures log integrity (only a DB admin outside the app could directly alter it, which is restricted).
* **Only Admin and Sysadmin roles can view the Audit Log** – caregivers have no access to audit logs whatsoever (not even their own activity history).
* Admin can **view the Audit Log** through an admin UI:
* By default, show recent entries (e.g., last 24 hours or last 100 events).
* Provide filters: date range selector, user filter (find all actions by caregiver John Doe), action type filter (e.g., show all "INCIDENT_CREATED" events), and client filter (e.g., show all events related to client Jane Smith).
* Searching by free text might also be useful (maybe search for a client name to see all events involving them).
* **Audit Log Usage:** The audit log is primarily intended for **manual browsing** by Admin/Sysadmin (filtering by user, date, action type, etc.) rather than automated analysis. Simple Cosmos DB queries are sufficient for this use case; no integration with Log Analytics or SIEM is required for MVP.
* The UI should not allow editing or deletion of log entries. The Developer/Sysadmin role may have direct database access for troubleshooting, but within the app, the logs are strictly view-only. This meets the requirement of keeping audit trails secure and unalterable[[11]](https://compliancy-group.com/hipaa-audit-log-requirements/#:~:text=HIPAA%20audit%20log%20requirements%20include,adhere%20to%20the%20stricter%20standard).
* **Retention:** Audit logs will be retained for at least **6 years** (the standard HIPAA retention period for documentation[[11]](https://compliancy-group.com/hipaa-audit-log-requirements/#:~:text=HIPAA%20audit%20log%20requirements%20include,adhere%20to%20the%20stricter%20standard)). We will not purge logs earlier than that. Cosmos DB can store this volume; if needed we can archive older logs to cheaper storage, but accessible on demand. The PRD ensures we state compliance with retention: logs kept >= 6 years, unless stricter state law requires longer[[11]](https://compliancy-group.com/hipaa-audit-log-requirements/#:~:text=HIPAA%20audit%20log%20requirements%20include,adhere%20to%20the%20stricter%20standard).
* The system should allow **exporting logs** (perhaps Admin can download a CSV of filtered log events) if needed for an external audit. This is a nice-to-have to facilitate audits.
* **Monitoring:** In addition to storing logs, we may integrate with Azure Monitor or alerts for certain events (like multiple failed login attempts could flag a security alert). This might be beyond the core app’s scope and more of an IT/DevOps configuration, but worth noting as a compliance measure (e.g., enabling Azure Security Center alerts[[13]](https://learn.microsoft.com/en-us/answers/questions/2265200/azure-ai-baa-hipaa-compliance#:~:text=d)).
* The audit log also covers **access control checks** – for instance, if someone attempted an unauthorized action, it should ideally log that attempt (e.g., “User X attempted to access Client Y’s record – access denied”). This ensures if someone is probing for data they shouldn’t see, there’s a record, which is useful for security reviews[[12]](https://compliancy-group.com/hipaa-audit-log-requirements/#:~:text=HIPAA%20requires%20healthcare%20organizations%20to,to%20the%20minimum%20necessary%20standard).

With these functional modules, the application will comprehensively support the daily operations of LenkCare Homes while maintaining a high level of data integrity and security.

## UI/UX Guidelines

LenkCare Homes is an internal tool but it targets a professional “premium” feel to instill confidence and ease of use. We will utilize **Ant Design** (AntD) as the primary UI library to achieve a consistent and polished user interface. Ant Design is an enterprise-grade React UI framework known for its well-designed components and adherence to usability principles[[14]](https://www.uxpin.com/studio/blog/ant-design-introduction/#:~:text=range%20of%20use%20cases%2C%20including,its%20ongoing%20development%20and%20support). The overall UX should be intuitive, with a focus on accessibility and efficiency for caregivers who may not be tech-savvy.

**Design Language & Consistency:** Using Ant Design ensures we have a unified design language across the app. All pages (from dashboards to forms to tables) will follow the AntD style guides – meaning consistent spacing, typography, and controls. This consistency helps users quickly learn the interface. We will stick to AntD components for common elements like navigation menus, form inputs, buttons, modal dialogs, etc., benefiting from their built-in behaviors and accessibility.

**Theming and Branding:** To give a premium feel, we may customize the Ant Design theme (colors, font if needed) to match LenkCare’s branding (if any) or a clean modern healthcare-inspired palette (soft blues/greens, etc.). AntD allows theme customization, so we’ll ensure the app doesn’t look like a generic template but rather has a distinct, professional appearance. We will maintain high contrast in colors for readability and accessibility – meeting at least WCAG 2.1 AA contrast requirements for text on background[[15]](https://github.com/ant-design/ant-design/discussions/53820#:~:text=Ant%20Design%20is%20aware%20of,AA%20%26%20AAA%20contrast%20ratios).

**Layout:** The app likely will have a main navigation (e.g., a sidebar or top menu) for switching between main sections (Clients, Caregivers, Homes, etc. for Admin; and Daily Logs, My Home for caregivers). Given it's a data-heavy application, we will use responsive **dashboard layouts** for Admin views (e.g., tables of clients, forms) and simplified views for caregivers focused on tasks. Ant Design's grid and layout components will help create a responsive design that works on desktop and tablets. The application is a **web app only with online access required** – no offline capability or dedicated mobile app is planned for MVP. Mobile use by caregivers could happen via responsive web design, so we aim for mobile-responsive design, though primary usage might be on tablets or desktop at the facility.

**Admin Dashboard:** The Admin homepage will feature a **dashboard with key performance indicators (KPIs)** providing an at-a-glance view of operations. Dashboard elements may include:
- Number of current residents across all homes
- Number of open/available beds
- Recent incidents (count this week/month)
- Upcoming client birthdays or important dates
- Quick access to recent activity

The dashboard design should be **clean, elegant, and premium** in feel while remaining easy to use for non-technical users.

**Forms and Data Entry:** A lot of user interaction is form-based (logging ADLs, vitals, etc.). We will use AntD’s Form components which provide validation feedback, labels, and inputs consistently. For example, required fields will automatically show an asterisk and error message if not filled. The design should minimize the number of clicks needed – e.g., use sensible defaults, allow selecting items easily (like date pickers for date fields, drop-downs for categories to avoid typing errors). **Short, clear labels and placeholders** will guide caregivers on what to input.

**Accessibility:** Ensuring the app is accessible is critical both ethically and because some users might have mild visual impairments. Ant Design components come with some ARIA attributes and keyboard support out of the box, but we must verify each page for: - **Keyboard navigation:** All interactive elements (links, buttons, form fields) should be reachable via Tab and activate via keyboard (Enter/Space). No functionality should be mouse-only. - **Screen reader support:** We will add ARIA labels or use appropriate semantic HTML for things like form sections. For example, group related form fields under clear headings, use aria-label on icon buttons (like a “view” icon for documents). - **Focus indicators:** Ensure that when elements are focused (via keyboard), there is a visible outline (default AntD focus style or custom if needed) so users know where they are. - **Form instructions and errors:** Provide text that screen readers can pick up for any instructions and real-time validation errors.

If Ant Design lacks in any accessibility area, we will extend components or add notes in development to address that. (Notably, Material Design might have more baked-in a11y, while AntD requires dev attention for full compliance[[16]](https://www.uxpin.com/studio/blog/ant-design-introduction/#:~:text=Accessibility). We commit to meeting accessibility needs in our implementation.)

**Premium Look & Feel:** Beyond correctness, the UI should convey quality. This includes: - Smooth interactions: Use AntD’s feedback components like spin loaders, skeleton screens for data loading, so that the app feels responsive and not stuck while data loads. Use **AntD Modal** dialogs for confirmations (like “Are you sure you want to discharge client?”). - Subtle use of icons and visuals: Ant Design’s icon library can be used for intuitive buttons (e.g., a plus icon on “Add Client”, a file icon for documents). We won’t overload with graphics, but a few well-chosen icons improve usability. - Clear typography hierarchy: Titles, subtitles, body text sized appropriately. Likely default AntD font is fine, but ensure section headings (like form section labels) are distinguishable. - Use of whitespace: Avoid clutter. Group related items (for instance, in a client profile view, group vitals together, ADLs together with accordion or tabs if needed). This prevents overwhelming the user with too much at once.

**User Guidance:** Since this is a tool that caregivers will use daily, we should incorporate guidance: - Field hints or tooltips (AntD has a Tooltip component) for any non-obvious input. E.g., on incident form, a tooltip could explain what to include in “Action taken”. - Perhaps a help section or FAQs if needed for complex modules, but ideally the design is straightforward enough.

**Responsive Behavior:** The UI should adapt to different screen sizes. An Admin likely uses a desktop, a caregiver might use a tablet. Using AntD grid, we can have e.g., a 3-column layout on desktop for a dashboard, collapsing to single column on mobile. Forms should stack vertically on narrow screens. We’ll test on common breakpoints.

**Performance in UI:** Virtualize long lists if needed (AntD List or Table virtualization for many records) to keep the UI snappy. Use pagination for tables (AntD Table supports pagination) especially for audit logs or lists of hundreds of clients.

**Error Handling & Feedback:** All interactive actions should provide feedback. For instance, after submitting an ADL log, show a success message (“ADL log saved”) perhaps using AntD’s message or notification component. If something fails (network error), show an error message dialog so the user knows to retry or contact support.

**Consistency with Ant Design guidelines:** We will follow AntD’s recommended practices for design and dev. AntD is specifically built for internal tools (“design language for background applications”[[17]](https://3x.ant.design/docs/spec/introduce#:~:text=Introduction%20,specs%20for%20internal%20background)), which fits our scenario. This will accelerate development and ensure a cohesive UX.

In summary, the UI/UX should enable caregivers and admins to perform their tasks efficiently with minimal training. By leveraging Ant Design’s comprehensive component library and focusing on clarity and accessibility, LenkCare Homes will look and feel like a modern, reliable enterprise application, despite being internally used. The premium feel comes from the smoothness of interactions, the polish of the design, and the confidence users have that the system is robust and professional.

## Technical Architecture

LenkCare Homes is built as a **two-tier application**: a **.NET Core Web API** backend and a **Next.js** frontend using Ant Design (no Tailwind). This architecture separates concerns clearly, with the backend handling all business logic, data access, and security operations, while the frontend focuses purely on UI rendering and user interactions.

This section outlines the key components of the architecture and how they interact:

* **Frontend:** Next.js (React framework) with Ant Design components
* **Backend:** .NET Core Web API hosted on Azure App Service
* **Database (Relational):** Azure SQL Database (for core PHI and structured data)
* **Secondary Database (NoSQL):** Azure Cosmos DB (for audit logs, append-only data, and non-core records)
* **File Storage:** Azure Blob Storage (for documents and file uploads, accessed via SAS URLs)
* **Authentication & Authorization:** ASP.NET Core Identity with email/password and TOTP for multi-factor authentication, plus role-based access control enforcement
* **UI Component Library:** Ant Design (as described in UI/UX section)

**Deployment Topology:** The application will be deployed on Azure. The architecture consists of two main components: the .NET Core Web API backend and the Next.js frontend. The Next.js frontend handles UI rendering with Ant Design components, calling backend APIs for data and security operations over HTTPS. Azure App Service will host both the .NET Core API and the Next.js frontend (potentially on separate App Service instances or in a single deployment depending on scale needs). We will have separate deployment slots or instances for environments (Dev, Staging, Prod) as needed, all under Azure for convenience.

**Database – Azure SQL:** All core PHI and relational data goes here. This includes tables for Users, Roles, Homes, Beds, Clients (patients), CaregiverAssignments (mapping caregivers to homes), ADL logs, Vitals, Activities, Incidents, etc. Azure SQL is a managed relational database that provides high availability, backups, and built-in encryption. Azure SQL uses **Transparent Data Encryption (TDE)** by default, encrypting all data at rest with AES-256[[3]](https://learn.microsoft.com/en-us/azure/security/fundamentals/encryption-atrest#:~:text=called%20Transparent%20Data%20Encryption,Azure). By using Azure SQL, we ensure ACID transactions for critical data (e.g., when admitting a client, updating bed occupancy and client record in one transaction).

We will also enable **Azure SQL Auditing**: this service logs database events (logins, queries, schema changes, etc.) to an audit log in Azure Storage or Log Analytics[[4]](https://learn.microsoft.com/en-us/azure/azure-sql/database/auditing-overview?view=azuresql#:~:text=Auditing%20for%20Azure%20SQL%20Database,Analytics%20workspace%2C%20or%20Event%20Hubs). For HIPAA compliance, configure auditing to include SELECTs/UPDATEs on PHI tables and successful/failed logins. These logs are encrypted in transit and at rest by Azure and can feed into a SIEM.

We will design the schema with appropriate foreign keys and indices (for example, client table links to home and bed tables, caregiver logs link to client, etc.) to ensure data integrity. The database will be accessible only by the application (using secure connection strings stored in Azure, possibly in Azure Key Vault for safety). No direct client access.

**Secondary Storage – Azure Cosmos DB:** Cosmos DB will primarily be used for **audit logs**. Each audit log entry is a small JSON document. By using Cosmos, we can ingest a high volume of log entries without impacting the transactional database. Cosmos offers flexible schema, which is good for logs that might have different shapes (login event vs. data edit event). Additionally, Cosmos can scale throughput independently – ensuring even if there’s a spike in activity, writing logs won’t slow down the core app.

We’ll use a container (collection) in Cosmos for AuditLogs, partitioned perhaps by date or user ID to distribute load. Cosmos DB also can be configured to only allow access from the App Service (using VNET integration or firewall rules)[[18]](https://learn.microsoft.com/en-us/azure/governance/policy/samples/hipaa-hitrust#:~:text=Policy%20learn,Audit%2C). Data in Cosmos is also encrypted at rest automatically, and it’s an Azure HIPAA-eligible service[[19]](https://kanerika.com/blogs/azure-cosmos-db/#:~:text=Cosmos%20DB%20meets%20strict%20security,GDPR%20for%20European%20privacy%20requirements).

**File Storage – Azure Blob:** All protected files (documents, images, etc.) will be stored in **Azure Blob Storage**. Blobs in Azure Storage are encrypted at rest by default (Storage Service Encryption). We will likely organize them by container or folder per client or per home for clarity, or use a naming convention that ties to client IDs.

Access to blobs will be via **Shared Access Signatures (SAS)** issued by the backend:

* The frontend requests a SAS token from the backend when a file upload or download is needed. The backend issues a **user-delegation SAS** (signed with Azure AD credentials) or a short-lived service SAS with specific permissions (read or write) and an expiration time. Microsoft explicitly recommends using SAS tokens for limited-time blob access in HIPAA scenarios[[6]](https://learn.microsoft.com/en-us/answers/questions/1138579/hippa-complaince-sas-blob-storage#:~:text=%40Anoop%20Mohanan,14%20is%20the%20best%20options)[[7]](https://learn.microsoft.com/en-us/azure/storage/common/storage-sas-overview#:~:text=A%20shared%20access%20signature%20,For%20example).
* For example, a 5-minute SAS URL scoped to a specific blob container grants upload rights and then expires. This ensures no long-term exposure of storage keys. The backend will log every time it generates a SAS (so we know who was granted what access).
* Always require **HTTPS** on SAS usage. We will follow Azure's security best practices for SAS: use HTTPS-only (no plaintext HTTP) and restrict IP range if possible[[7]](https://learn.microsoft.com/en-us/azure/storage/common/storage-sas-overview#:~:text=A%20shared%20access%20signature%20,For%20example). The frontend code will use these short-lived URLs directly to PUT/GET the file data from Azure Blob; the backend need never handle the file bytes themselves except to generate SAS.

The Blob container will not be public; all access requires auth. We will enforce TLS for any blob access as well. The Blob Storage account will have a Business Associate Agreement (BAA) in place through Azure, meaning Microsoft is contractually bound to handle that data in a HIPAA-compliant way[[20]](https://learn.microsoft.com/en-us/answers/questions/2265200/azure-ai-baa-hipaa-compliance#:~:text=2,become%20eligible%20for%20use%20with)[[21]](https://learn.microsoft.com/en-us/answers/questions/2265200/azure-ai-baa-hipaa-compliance#:~:text=incorporated%20through%20the%20Microsoft%20Data,For%20reference%20on%20BAA%20Overview).

**Authentication – ASP.NET Core Identity:** We use **ASP.NET Core Identity** for user management in the .NET Core Web API backend. By default it supports email/password and built-in 2FA (TOTP via authenticator apps)[[2]](https://learn.microsoft.com/en-us/aspnet/core/security/authentication/mfa?view=aspnetcore-10.0#:~:text=MFA%20TOTP%20%28Time,Algorithm), which we will enable to meet HIPAA's requirement for strong authentication. All users must use HTTPS (TLS) for login. - *.NET Identity & 2FA*: Configure `AddIdentity()` with `.AddDefaultTokenProviders()` to enable email/password and TOTP. Use an Authenticator app (e.g. Google/Microsoft Authenticator) for the second factor. - *RBAC*: Define roles and permissions in the backend. The SysAdmin role, for instance, will be restricted from UI actions on PHI resources. They can view patient lists or home records (with non-sensitive fields only) but **cannot** see sensitive PHI. Only authorized clinical users can view/edit actual PHI. - *Sessions/Cookies*: The app will use secure cookies for session tokens. These will be HTTPOnly and Secure, to mitigate XSS and network sniffing risks. The cookies will have appropriate SameSite settings since our app is single-origin. - All authentication-related events (login, logout, failed attempt, MFA challenge) will create audit log entries as noted.

**Next.js Frontend:** The frontend will be built in **Next.js** (React) using **Ant Design** components for UI consistency and rapid development (no Tailwind). Next.js supports server-side rendering for some pages (especially for initial load, which is good for performance). For data operations, the Next.js frontend will call the .NET Core Web API backend over HTTPS. Authentication state (cookies or JWT) will be managed securely (HttpOnly cookies or similar). - **Ant Design**: Provides a rich component library (forms, tables, modals) for a consistent, enterprise-ready UI. - **Data fetching**: Next.js pages/components will call backend API endpoints via fetch or Axios to retrieve or update data. The frontend never directly accesses databases. - **File uploads/downloads**: The React UI will never directly contain storage credentials. Instead, it will request a pre-signed SAS URL from the backend API to upload or download files from Azure Blob Storage.

Using Next.js gives us the following benefits: - **Built-in Routing** for pages, which we can use to separate views for different roles (e.g., pages under /admin/\* vs /caregiver/\*). - **Secure routing**: we will use middleware or route guards to ensure authentication before accessing certain pages (for instance, redirect to login if not authenticated, or show 403 if unauthorized). - **CSR & SSR mix**: For most data entry pages, client-side rendering after initial load is fine. We will likely fetch data via AJAX calls (using a library or fetch) so the interface feels dynamic. But some pages (like a static admin dashboard summary) could be SSR.

**Azure App Service:** The application runs on Azure App Service. The .NET Core Web API can run on Azure App Service for Windows or Linux. The Next.js frontend can be hosted on a separate App Service instance or as a static web app. App Service provides auto-scaling capabilities, though our user base is relatively small (internal staff). We can configure it to scale out if needed (e.g., if reporting or heavy usage peaks at certain times). App Service also integrates with Azure AD if needed for additional security.

We will enable **Application Insights** or Azure Monitor on the App Service to track errors and performance. This is outside of the app’s functionality but is part of our architecture to maintain the app (logging exceptions, etc., separate from the audit log which is functional logging).

**Security Architecture:** Beyond just the services, our architecture considers security at multiple levels: - The App Service will be configured to only allow HTTPS (enforce TLS 1.2+), and we'll use an Azure-managed certificate or a custom domain certificate for the front-end URL. - We will likely restrict access such that the database and storage are not accessible from the public internet, only from the App Service. This can be done via VNet integration or firewall rules (e.g., allow Azure service traffic and deny others, or use managed identities to access). - **Network and Data flow:** User connects over HTTPS to Next.js frontend -> Next.js calls .NET Core Web API (App Service) -> .NET Core API communicates with Azure SQL and Cosmos over secure connections within Azure's network -> data stored in respective places. Blob Storage access flows via secure SAS tokens issued by the backend. No component is left unsecured.

**ASP.NET Core Identity on Azure:** Since ASP.NET Core Identity is running in our .NET Core Web API, we treat it as part of the backend app. We need to ensure secrets (like encryption keys for TOTP secrets or session signing keys) are stored safely, using Azure Key Vault or environment variables on App Service with proper access controls. Also, if the system sends emails (for invites, password resets), we need an email service (SendGrid or similar) configured. This will be configured with SMTP credentials in settings, also kept in Key Vault or secure App Settings.

**Performance Considerations:** - Using Azure SQL ensures reliable performance for relational operations, but we will also use caching strategies for frequently read data. For example, list of homes or caregiver assignments might be cached in memory or a distributed cache if needed. But given scale, likely not urgent. - Cosmos DB is highly performant for writes and okay for reads (especially with proper partitioning). We will partition audit logs perhaps by year or user to keep queries efficient. - Blob Storage scales with bandwidth; serving documents should be fine, but we might use Azure Content Delivery Network (CDN) if documents are large or accessed frequently. However, since it’s internal use and not heavy media streaming, CDN is optional. - Next.js and App Service can handle concurrent users easily; we might set an expectation that at least 50-100 concurrent users can be served without noticeable slowdowns (which is above what typical usage might be, but good to plan for growth).

**Scalability & Maintainability:** - The architecture allows adding more homes and users without code changes. If the operator expands, the same system can onboard more caregivers and clients. Azure services can scale vertically or horizontally (e.g., upgrading the SQL DB tier or adding more App Service instances). - We separate concerns: The frontend is just UI, the backend handles logic, the databases store data, making it easier to maintain each part. Future developers (or the Developer role) can modify one component (like updating a form or stored procedure) without breaking others, if done carefully. - Logging and monitoring (through audit logs and App Insights) provide maintainers insight into system health and usage patterns.

**Integration and Third-Party:** Currently, the system is self-contained (no third-party APIs for EHR or such). If future integration (like sending data to a state health system or pulling pharmacy data) is required, the architecture (especially using Azure functions or adding microservices) can accommodate that. We mention this only as a note for extensibility.

In summary, the technical architecture leverages Azure's PaaS offerings to build a secure, scalable application. All sensitive data is either in Azure SQL (with encryption and backups), or Azure Blob (encrypted), or Cosmos (encrypted), all under Azure's compliance envelope. The use of .NET Core Web API with ASP.NET Core Identity and Next.js with Ant Design provides a robust, enterprise-ready framework with built-in modern features (like TOTP MFA and SSR), reducing the need to reinvent wheels and thus lowering risk and development time.

## HIPAA Compliance & Security Measures

Compliance with **HIPAA (Health Insurance Portability and Accountability Act)** is a central requirement for LenkCare Homes. The application will handle PHI, so both technical safeguards and administrative practices must align with HIPAA rules. Below is a summary of how the system addresses key HIPAA security and privacy requirements:

**1. Encryption of PHI at Rest:** All databases and storage containing PHI are encrypted at rest. Azure SQL uses **Transparent Data Encryption (TDE)** with AES-256 encryption by default[[3]](https://azure.microsoft.com/en-us/explore/trusted-cloud/privacy#:~:text=,between%20user%20devices%20and%20Microsoft), ensuring any data on disk or backups is encrypted. Azure Blob Storage similarly encrypts all blobs automatically with AES-256[[3]](https://azure.microsoft.com/en-us/explore/trusted-cloud/privacy#:~:text=,between%20user%20devices%20and%20Microsoft). Azure Cosmos DB also encrypts data at rest. This means if someone were to get physical access to the drives, the data would be unreadable without the keys. We will use Azure-managed keys for simplicity, but could consider customer-managed keys via Azure Key Vault if needed for extra control.

**2. Encryption of PHI in Transit:** All network communication that involves PHI will be over secure channels: - The web app is served exclusively over **HTTPS with TLS 1.2+**. We will enforce HSTS so that browsers always use HTTPS. This protects data like login credentials, client records, etc., as they travel between user and server[[6]](https://azure.microsoft.com/en-us/explore/trusted-cloud/privacy#:~:text=,IPsec). - Internal communication between the app and Azure services (SQL, Blob, Cosmos) also goes through encrypted channels. Azure SQL requires encryption by default on connections. Blob and Cosmos calls are HTTPS. - No part of the app should ever send PHI via an insecure protocol (e.g., no HTTP, no FTP, etc.). Even internal URLs for images or files will have SAS tokens over HTTPS.

**3. Multi-Factor Authentication (MFA):** All user accounts (Admins, Caregivers, Sysadmins) must authenticate with MFA. We implement TOTP-based MFA through ASP.NET Core Identity[[2]](https://learn.microsoft.com/en-us/aspnet/core/security/authentication/mfa?view=aspnetcore-10.0#:~:text=MFA%20TOTP%20%28Time,Algorithm). This is a critical safeguard because even if a password is compromised, an attacker would need the second factor code to log in. MFA significantly reduces the risk of unauthorized access to PHI. For account recovery, the use of backup codes or admin-assisted reset ensures MFA can be restored securely without backdoors. System admins will use unique credentials and be required to use MFA (as required by HIPAA)[[1]](https://compliancy-group.com/azure-hipaa-compliance/#:~:text=,that%20it%20is%20accessed%20in).

**Password Policy:** The following password requirements will be enforced via ASP.NET Core Identity configuration:
- Minimum **8 characters**
- At least **1 number**
- At least **1 special character**
- At least **1 lowercase letter**
- At least **1 uppercase letter**
- **No account lockout** after failed attempts (to avoid denial-of-service scenarios; MFA provides sufficient protection against brute force attacks)

**4. Access Control & Minimum Necessary:** The system is built with role-based access control to enforce the principle of least privilege[[1]](https://learn.microsoft.com/en-us/answers/questions/2265200/azure-ai-baa-hipaa-compliance#:~:text=c). Users only see the data they need for their role: - Caregivers see data only for clients in their assigned home(s), and only certain data (care logs, etc., not all administrative data). - Caregivers cannot see other caregivers’ profiles or system settings. - Admins have broader access, but even they operate through the app interface which partitions functions appropriately. - Developer/Sysadmin have full access for maintenance but will use it sparingly. - Within the caregiver role, document access is further restricted on a per-document basis as described; this aligns with “minimum necessary” rule by not exposing all documents to all caregivers by default[[12]](https://compliancy-group.com/hipaa-audit-log-requirements/#:~:text=HIPAA%20requires%20healthcare%20organizations%20to,to%20the%20minimum%20necessary%20standard).

**5. No Public Access / Account Creation:** There is no ability for the general public to sign up or access the system. Only invited staff can log in. This reduces exposure. Additionally, the application might be deployed on an internal network or VPN if extra security is desired (though with proper web security and MFA, internet deployment is acceptable under HIPAA as long as all other safeguards are in place). We have a **business associate agreement (BAA)** with Microsoft Azure, which covers the Azure services handling PHI[[20]](https://learn.microsoft.com/en-us/answers/questions/2265200/azure-ai-baa-hipaa-compliance#:~:text=2,become%20eligible%20for%20use%20with). Microsoft’s BAA is included as part of Azure’s terms for healthcare customers[[21]](https://learn.microsoft.com/en-us/answers/questions/2265200/azure-ai-baa-hipaa-compliance#:~:text=incorporated%20through%20the%20Microsoft%20Data,For%20reference%20on%20BAA%20Overview), ensuring that Azure as a cloud provider is also obligated to protect the data in line with HIPAA.

**6. Audit Controls and Monitoring:** We will log detailed audit trails of all PHI access and system events. This includes user logins, logout, failed attempts, access to patient records, file downloads/uploads, and any PHI modifications[[8]](https://www.kiteworks.com/hipaa-compliance/hipaa-audit-log-requirements/#:~:text=2,Activities). Each audit entry will capture: *who* (user ID), *when* (timestamp), *what* (action and which resource, e.g., "Viewed Patient #12345 record"), *outcome* (success/fail), and *origin* (IP address)[[9]](https://www.kiteworks.com/hipaa-compliance/hipaa-audit-log-requirements/#:~:text=To%20meet%20compliance%20requirements%2C%20every,include%20these%20critical%20data%20elements). Azure SQL's auditing and Application logs will feed into a centralized secure log store (e.g., Azure Monitor logs or a log analytics workspace). We will treat logs as write-once (immutable) – for example using append-only storage or WORM policies – to prevent tampering. Logs will themselves be encrypted at rest (AES-256) and transmitted to SIEM via TLS[[10]](https://www.kiteworks.com/hipaa-compliance/hipaa-audit-log-requirements/#:~:text=3). **Log access control:** Audit logs must be protected. Only a limited set of roles (e.g., Compliance Officer, Security Admin) can view raw logs. No user (including sysadmin) can modify or delete logs once written[[11]](https://www.kiteworks.com/hipaa-compliance/hipaa-audit-log-requirements/#:~:text=4,Access%20Controls). These audit logs are kept for a minimum of **six years** (HIPAA retention requirement)[[12]](https://www.kiteworks.com/hipaa-compliance/hipaa-audit-log-requirements/#:~:text=6). We'll implement a log retention policy (e.g., storing in cool/cold storage after one year) and ensure automated backups. We will also set up automated monitoring and alerts (e.g., via Azure Sentinel or Azure Monitor) for suspicious patterns, such as bulk PHI exports or multiple failed logins[[13]](https://www.kiteworks.com/hipaa-compliance/hipaa-audit-log-requirements/#:~:text=7).

**7. Immutable Logs:** The audit log’s design is append-only (immutable). No one in the application can alter or delete log entries. This integrity of logs ensures that if an incident occurred, the evidence trail is preserved[[22]](https://compliancy-group.com/hipaa-audit-log-requirements/#:~:text=HIPAA%20Audit%20Log%20Requirements). In the rare case that a log entry needs correction (maybe a false entry), the practice would be to add a compensating entry, not remove the original.

**8. User Session Security:** Sessions will have appropriate timeouts. For example, if a caregiver is logged in and idle for a certain period (say 15 minutes), the system should auto-log them out or require re-auth (especially re-auth for critical actions or after a long idle, maybe via prompting MFA again if high-risk). This prevents someone else from using a logged-in workstation. The exact timeout policy can be configured according to organizational security policy.

We will also ensure **device security**: ASP.NET Core Identity's session management features will be used. Users might have to re-confirm new devices via an email or code, adding another layer (this could be optional, but a nice security feature).

**9. Data Minimization and Segregation:** We will store only necessary PHI. For instance, if Social Security Numbers or financial info aren’t needed, we won’t collect them to reduce risk. Within the database, sensitive fields can be additionally encrypted at the application level if deemed necessary (Azure SQL TDE covers disk, but we could do field encryption for, say, any particularly sensitive field, using Always Encrypted or custom encryption). However, that might complicate searching, so we’ll evaluate necessity. Likely name, DOB, health info are fine under standard encryption.

**10. Backups and Recovery:** Azure SQL provides automated backups with point-in-time restore. We consider backup retention to ensure data can be recovered in disaster situations – which is part of HIPAA’s contingency planning requirements. Likewise, documents in Blob Storage can have soft-delete and versioning enabled, so if something is deleted accidentally, it can be recovered. We will enable these features to prevent data loss.

**11. Disposal of Data:** If PHI data needs to be disposed (e.g., removing a client’s record after the retention period), we will follow proper procedures. In practice, we might rarely delete – more often we deactivate or archive. But if deletion is needed (past retention), Azure ensures that deleted data is wiped from drives and not accessible, fulfilling the requirement for proper disposal.

**12. Business Associate Agreements:** As mentioned, all cloud services (Azure) involved are under Microsoft’s BAA[[20]](https://learn.microsoft.com/en-us/answers/questions/2265200/azure-ai-baa-hipaa-compliance#:~:text=2,become%20eligible%20for%20use%20with). If we use any third-party email service (like SendGrid) to send notifications that might include PHI (we would avoid including PHI in emails ideally), we would need a BAA with that provider too. The current plan is to not send PHI via email, just system alerts, so we may not need additional BAAs beyond Azure.

**13. Physical and Administrative Safeguards:** While mostly outside the software scope, it’s worth noting: - Azure datacenters have robust physical security (covered by Azure’s compliance). - Administratively, LenkCare will ensure only trained staff have accounts and that they follow policies (like not sharing passwords, logging out of shared devices, etc.). The app can support this by enforcing password complexity and changes if needed. - We will also have a procedure for **terminating access**: e.g., if a caregiver leaves employment, the Admin must promptly deactivate their account to prevent lingering access.

**14. Testing and Validation:** Before launch, we will conduct security testing, including vulnerability scans or even a penetration test, to ensure no obvious weaknesses (like SQL injection, XSS, etc.). Next.js and Azure mitigate many generic issues, but we must be careful with any custom code. We’ll also test that audit logging is capturing what it should, and that role restrictions truly prevent access (attempt some misuse scenarios to verify the defenses).

**15. HIPAA Privacy Rule Considerations:** The app mostly deals with internal use of PHI, which is allowed under HIPAA for treatment, payment, operations purposes. We ensure that only those involved in a client’s care (the caregivers for that home, and the admins) can see their data, which aligns with the privacy rule. If any *disclosures* outside the system are needed (like sending records to a doctor or family), that’s a process outside this app’s direct scope, but the app facilitates generating those records (reports). Handling of such disclosures should follow policy (e.g., only via secure email or portal), but that’s outside the PRD’s immediate build – just a note that the system doesn’t directly email PHI unless absolutely necessary and authorized.

In conclusion, the application’s design incorporates **multiple layers of security** – encryption, MFA, RBAC, audit trails – in line with HIPAA’s Security Rule. By using Azure’s compliant infrastructure and following best practices (like strong access control and monitoring), LenkCare Homes will maintain the confidentiality, integrity, and availability[[12]](https://compliancy-group.com/hipaa-audit-log-requirements/#:~:text=HIPAA%20requires%20healthcare%20organizations%20to,to%20the%20minimum%20necessary%20standard) of sensitive health data. Regular reviews and updates will be performed to ensure ongoing compliance, especially as HIPAA guidelines or the operational needs evolve.

## Non-Functional Requirements

In addition to the functional capabilities, LenkCare Homes must meet several non-functional requirements to ensure the system is robust, user-friendly, and maintainable.

**1. Performance:** - The application should provide a **fast and responsive user experience**. Target page load for main views (with moderate data) is within 2-3 seconds on a normal broadband connection. Interactive actions (like saving a form, loading a client’s details) should typically complete in under 1 second for the user (not including network latency). - The system should handle the expected load: e.g., if there are 5 homes with 10 caregivers each, all using the system concurrently, the app and database should comfortably handle ~50 concurrent users performing operations. We anticipate at most a few hundred records (clients) and logs per day; Azure SQL and the app service should be provisioned to easily handle this. If load grows, the architecture should allow scaling (App Service scale-out, upgrading DB tier). - For reporting, generating a PDF for a month’s data should not exceed ~5-10 seconds; if it does, we might implement asynchronous report generation (notify the user when ready). But ideally, most reports being a few hundred entries should be quick.

**2. Scalability:** - The design should support **scaling up** (more resources per instance) and **scaling out** (more instances). For example, if the number of homes or users doubles, we can increase the Azure SQL performance tier or add more CPU to the App Service without needing to redesign the system. - The stateless nature of Next.js server (aside from DB) allows multiple instances behind a load balancer if needed. Sessions can be handled via tokens so any instance can serve a user. - Cosmos DB and Blob storage are inherently scalable for their roles (Cosmos can auto-scale RU/s, Blob can handle large files and many requests). - We also consider future scaling in terms of features: the data model can accommodate new modules (like medication tracking or billing) without major refactoring, thanks to using established Azure services and a modular approach.

**3. Reliability & Availability:** - **Uptime goal:** 99.9% or higher uptime for the production system. Azure App Service and SQL can achieve this with proper configuration (e.g., using Standard tiers or above for high availability). We will deploy in a single region (with possibility of region failover if needed in disaster, though that might be overkill for internal tool; backups are the main DR strategy). - The system should be fault-tolerant to a degree: transient errors (like a brief DB connection drop) should be handled gracefully (auto-retries, etc., using libraries or Azure transient fault handling). - Automated backups (for database daily backups, and maybe weekly exports of key data) will be in place so that in case of a severe issue, data can be restored to within at most 24 hours prior (point-in-time restore helps even narrower). - No single user action should crash the system. We will validate inputs and handle exceptions so that one bug doesn’t take down the whole app (for example, if an API call fails, it returns an error to user but the server keeps running).

**4. Maintainability:** - The codebase will be organized logically (Next.js encourages a certain structure). We will separate concerns (UI components, API route handlers, database access logic possibly using an ORM or query builder for clarity). - We will write **clear documentation** for the code and the system (especially any complex business logic, e.g., “beds become available on discharge” will be documented in code). - The PRD serves as a blueprint; we might also maintain an updated technical document or Wiki for developers with any changes. - Logging within the application (not just audit logs) will be implemented to help debug issues – e.g., important errors or warnings logged to console/App Insights. - **Testing:** We should have a test plan. Unit tests for critical utility functions, integration tests for API endpoints, and user acceptance testing for main use cases (maybe manual or automated with Playwright/Selenium). Particularly, before production, test scenarios like “Caregiver should not access unauthorized data” must be verified. - **DevOps:** We will utilize a CI/CD pipeline (e.g., GitHub Actions or Azure DevOps) to automatically test and deploy changes to a staging environment, then to production. This ensures consistent deployments and catches issues early.

**5. Security (Additional Non-functional Aspects):** - We’ve covered many in HIPAA section, but also: - Use of secure coding practices to prevent OWASP top 10 vulnerabilities (we will input-validate on server side, use parameterized queries or ORM to prevent SQL injection, encode outputs to prevent XSS, etc.). - Penetration testing or vulnerability scanning should be done annually or when major changes are made. - The system should have a plan for security patches (e.g., update dependencies regularly, maintain the environment – Azure App Service provides a patched OS and we update our Node and libraries).

**6. Usability & Training:** - Although an internal tool, it should be **usable without extensive training**. We assume a short training session or guide will be provided to staff, but the design should be intuitive. Success criteria: New caregivers can use the core features (logging ADLs, notes) after a brief orientation, and the error rate (using wrong functions etc.) should be minimal. - Provide helpful error messages and guide the user (for example, if they try to submit a form missing info, highlight it clearly).

**7. Compatibility:** - The app will target modern browsers (Chrome, Firefox, Edge, Safari) and should also work on iPads or Android tablets if used. We will not support IE11 (obsolete) and may not fully support very small phone screens if that’s not an expected use case – however, basic functionality should still be accessible on a phone in case of emergency access. - Ensure that any use of browser-specific features is checked (AntD is mostly standard and polyfilled where needed). - If printing pages or reports directly from the browser, ensure print styles are decent (especially if an admin might print a screen in a pinch).

**8. Data Integrity:** - Non-functional but critical: no data loss or corruption. Transactions will be used for multi-step operations. We will put constraints in the DB to avoid inconsistent data (e.g., a log must reference a valid client, etc.). If an operation fails mid-way, system should roll back (if same transaction) or at least not leave orphan records. - Use SQL foreign keys and Cosmos consistency (we can use strong consistency on Cosmos since it’s a single region to guarantee writes are immediately visible for audit logs).

**9. Auditing & Compliance:** - Apart from HIPAA, if there are state-specific regulations for adult family homes, the system should be flexible to meet those (for instance, Washington state might have certain reporting requirements). Non-functional in a sense: the system should allow extraction of required data to comply with any audit. - The system design should be open to undergo third-party audits (security audits, HIPAA compliance audits). We’ll maintain documentation of our architecture and decisions to satisfy such inquiries easily.
**Data Retention Policy:** The system will follow HIPAA's minimum retention requirement of **6+ years** for all PHI data (client records, care logs, audit logs, etc.). Data will be retained indefinitely unless a specific purge request is made by authorized personnel. After the minimum retention period, data may be purged upon request following proper data disposal procedures. No automated purging will be implemented – all data deletion requires explicit administrative action.
**10. Disaster Recovery:** - In the event of a major outage or data loss event, we must be able to restore service quickly. Non-functionally, we define RPO (Recovery Point Objective) and RTO (Recovery Time Objective): - RPO: Ideally < 1 hour (meaning we might lose at most 1 hour of data in a disaster, given frequent backups or geo-redundant services). - RTO: Ideally < 4 hours to get system back up in another region or from backups. - Azure’s features (geo-redundant storage, geo-restore for SQL) can support this. We may not initially invest in multi-region deployment, but it’s a consideration for critical systems. At least ensure backups are off-site (Azure does GRS backups).

**11. Future Maintainability & Extensibility:** - The system should be built in a way that adding new features (like a Medication logging module, or an integration with an electronic health record system) is feasible without a complete rewrite. This means using modular architecture, standard protocols (maybe building a RESTful API that even future mobile apps could use). - We might create the API in a REST or GraphQL style such that later, a mobile app or an external service could integrate if needed (for example, an emergency service could pull up a client’s info via an API if authorized).
**Integration Scope:** For the initial release, LenkCare Homes is a **standalone system** with no integrations to external systems (pharmacy, billing, EHR, etc.). The architecture supports future integrations if needed, but they are explicitly out of scope for MVP.
**12. Cost Efficiency:** - While not a direct user requirement, since it’s internal, we should consider running costs. Azure services cost money, so we size things appropriately: - Use Azure SQL tier that meets performance but not grossly over-provisioned. - Use Cosmos DB with autoscale to handle logs but keep costs in check by tuning RUs. - Utilize App Service plan that can scale down in off-hours if possible. - The architecture should allow adjusting components for cost (e.g., if Cosmos is too expensive for logs, we could opt to log to a cheaper store like Azure Table or Blob in the future; but Cosmos is used for its querying ability if needed). - This doesn’t affect function, but it’s a maintainability/operational consideration.
**13. Notifications:** For the initial release, the system will only send **incident alert notifications** to Admins when a new incident report is filed. Additional notification types (ADL decline alerts, expiring document reminders, task reminders, etc.) are out of scope for MVP but may be considered for future enhancements.
By meeting these non-functional requirements, LenkCare Homes will not only deliver the needed features but will do so reliably, securely, and in a way that supports the business over the long term. The system’s success will be measured not just by features delivered, but also by its uptime, user satisfaction, and audit results showing compliance.

## Glossary

To ensure clarity for all readers of this document, below are definitions of key terms and acronyms used:

* **ADL (Activities of Daily Living):** Basic daily self-care tasks. In this context, refers to the six tasks measured by the Katz Index: bathing, dressing, toileting, transferring, continence, and feeding[[7]](https://www.h2hhc.com/blog/katz-index-of-independence#:~:text=The%20Katz%20Index%20of%20Independence,toileting%2C%20transferring%2C%20continence%2C%20and%20feeding). Used to gauge an individual's functional independence.
* **Admin/Owner:** The user role with full administrative privileges in the system. Likely the owner or manager of the adult family homes, responsible for overseeing operations and data.
* **Azure App Service:** A cloud hosting platform by Microsoft Azure for web applications. We use it to deploy the Next.js application. It provides features like automatic scaling, security patches, and integration with other Azure services.
* **Azure SQL Database:** A managed relational database service on Azure. Used to store structured data for the app (clients, users, logs, etc.) with high security and availability.
* **Azure Cosmos DB:** A globally distributed, multi-model database service on Azure. Here used as a NoSQL store for audit logs and other non-relational data. Ensures fast writes and flexible schema.
* **Azure Blob Storage:** Azure's service for storing unstructured data (like files, images). Used in LenkCare Homes to store documents (PDFs, images) uploaded for clients, with secure, scalable storage.
* **BAA (Business Associate Agreement):** A legal contract required under HIPAA between a healthcare provider (or covered entity) and a service provider (business associate) that will handle PHI. It mandates the service provider’s responsibility in protecting PHI[[20]](https://learn.microsoft.com/en-us/answers/questions/2265200/azure-ai-baa-hipaa-compliance#:~:text=2,become%20eligible%20for%20use%20with). In our context, we have a BAA with Azure/Microsoft for their cloud services.
* **Caregiver:** The user role for staff who provide care to clients in homes. They have limited access, mainly to enter daily logs and view pertinent client info in their assigned home.
* **Client:** In this document, refers to the resident of an adult family home under care (not an application client). Their health and personal data are managed in the system.
* **Cosmos Container:** A table-like collection in Azure Cosmos DB where JSON documents (audit log entries) are stored.
* **HIPAA:** U.S. Health Insurance Portability and Accountability Act. It includes privacy and security rules for protecting PHI. Our system must comply with its requirements (encryption, access control, audit logs, etc.).
* **PHI (Protected Health Information):** Any health-related information that can identify an individual (e.g., medical records, health status, care logs with personal identifiers). In LenkCare Homes, most data (client profiles, care notes, etc.) is PHI and thus must be protected.
* **MFA (Multi-Factor Authentication):** An authentication method requiring multiple pieces of evidence to log in. We use password + TOTP code as two factors for user login[[2]](https://learn.microsoft.com/en-us/answers/questions/2265200/azure-ai-baa-hipaa-compliance#:~:text=%2A%20Implement%20Role,Reference).
* **TOTP (Time-Based One-Time Password):** A temporary 6-digit code generated by an authenticator app (like Google Authenticator) that refreshes typically every 30 seconds[[2]](https://learn.microsoft.com/en-us/aspnet/core/security/authentication/mfa?view=aspnetcore-10.0#:~:text=MFA%20TOTP%20%28Time,Algorithm). Used as the second factor in MFA.
* **ASP.NET Core Identity:** The built-in authentication and authorization system in ASP.NET Core, integrated into our .NET Core Web API backend to handle user accounts, sessions, roles, and MFA. It simplifies implementing secure login, user management, and RBAC.
* **Katz Index:** A standard assessment tool for ADLs that scores independence in six areas (see ADL above). Mentioned as the basis for how we track ADLs[[7]](https://www.h2hhc.com/blog/katz-index-of-independence#:~:text=The%20Katz%20Index%20of%20Independence,toileting%2C%20transferring%2C%20continence%2C%20and%20feeding).
* **ROM (Range of Motion) exercises:** Physical exercises to maintain joint flexibility. In our context, caregivers log ROM activities they perform with clients.
* **Audit Log:** A record of all significant actions and events in the system, especially those involving PHI access. It’s required for compliance to monitor who accessed or altered data[[9]](https://compliancy-group.com/hipaa-audit-log-requirements/#:~:text=Application%20audit%20trails,application%20records%20associated%20with%20ePHI)[[12]](https://compliancy-group.com/hipaa-audit-log-requirements/#:~:text=HIPAA%20requires%20healthcare%20organizations%20to,to%20the%20minimum%20necessary%20standard).
* **Immutable (Audit Log):** Not modifiable. Once an audit entry is created, it isn’t changed or removed, ensuring a trustworthy trail.
* **Role-Based Access Control (RBAC):** Authorization mechanism where permissions are tied to roles rather than individuals directly. Our roles (Admin, Caregiver, Sysadmin) have defined permissions and the system checks roles to grant or deny access to functions/data[[1]](https://learn.microsoft.com/en-us/answers/questions/2265200/azure-ai-baa-hipaa-compliance#:~:text=c).
* **Protected Data in Transit/At Rest:** Common security terms. “In transit” means data moving over a network (protected via TLS encryption[[6]](https://azure.microsoft.com/en-us/explore/trusted-cloud/privacy#:~:text=,IPsec)), “at rest” means data stored on disk/databases (protected via encryption on disk[[3]](https://azure.microsoft.com/en-us/explore/trusted-cloud/privacy#:~:text=,between%20user%20devices%20and%20Microsoft)).
* **Audit Trail:** Synonymous with audit log; the historical record that can be examined to see the sequence of actions on the system.
* **Incident (in caregiving context):** An event that is not part of routine care and is often harmful or unusual (e.g., falls, errors, injuries). Needs special reporting and handling.
* **Next.js:** A React framework that supports both server-rendered and static pages. Used for our front-end (and some backend API routes). It provides structure and optimizations for building the web app.
* **Ant Design (AntD):** A UI design system and component library for React. Provides pre-built, styled UI components and follows an “enterprise” design language for consistency and quality[[14]](https://www.uxpin.com/studio/blog/ant-design-introduction/#:~:text=range%20of%20use%20cases%2C%20including,its%20ongoing%20development%20and%20support).
* **WCAG:** Web Content Accessibility Guidelines. A set of standards for making web content accessible to people with disabilities. We aim for WCAG 2.1 AA compliance in the UI (color contrast, keyboard navigation, etc.).